<!DOCTYPE>
<html>
<head>
<title>Assembler for simple risc</title>
<link rel="stylesheet" href="main.css" type="text/css">
<meta http-equiv="author" content="sai">
</head>

<body>
<div class="container">
<h1>Simple Risc</h1>
	<h3>Basic Characteristics</h3>
	<ol>
	<li>It has 32-bit Instrunction register</li>
	<li>It has 21 instrunctions</li>
	<li>It has 2 flag bits</li>
	<li>It has 16 register (r0-r15)</li>
	<li>It has mainly two Data Instruction</li>
	<ul>
	<li>Register (R) Type Instruction</li>
	<li>Immediate (I) type instruction</li>
	</ul>
	<li>It can take at max three operands for one instruction</li>
	<ul>
	<li>One Destination Register and two Source Register</li>
	<li>One Destination Register and One Source Register</li>
	<li>One Destination Register and One immediate</li>
	<li>One Destination Register and One Source Register</li>
	<li>One Destination Register and One source Register and One Immediate</li>
	<li>No Operand</li>
	</ul>
	<li>The immediate instruction can have modifiers like u,h</li>
	</ol>

<h3>The category the  instrunction comes under :-</h3>
	<table>
		<tr>
		<th>Type of Operation</th>
		<th>Opcode</th>
		<th>Max No of Operands</th>
		<th>Code</th>
		<th>Code in decimal</th>
		</tr>
		<tr>
    <td>Data Transfer/Movement</td>
    <td>mov</td>
    <td></td>
    <td>01001</td>
    <td>9</td>
</tr>
<tr>
    <td>Data Transfer/Movement</td>
    <td>ld</td>
    <td></td>
    <td>01110</td>
    <td>14</td>
</tr>
<tr>
    <td>Data Transfer/Movement</td>
    <td>st</td>
    <td></td>
    <td>01111</td>
    <td>15</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>add</td>
    <td></td>
    <td>00000</td>
    <td>0</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>sub</td>
    <td></td>
    <td>00001</td>
    <td>1</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>mul</td>
    <td></td>
    <td>00010</td>
    <td>2</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>div</td>
    <td></td>
    <td>00011</td>
    <td>3</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>mod</td>
    <td></td>
    <td>00100</td>
    <td>4</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>cmp</td>
    <td></td>
    <td>00101</td>
    <td>5</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>and</td>
    <td></td>
    <td>00110</td>
    <td>6</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>or</td>
    <td></td>
    <td>00111</td>
    <td>7</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>not</td>
    <td></td>
    <td>01000</td>
    <td>8</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>lsl</td>
    <td></td>
    <td>01010</td>
    <td>10</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>lsr</td>
    <td></td>
    <td>01011</td>
    <td>11</td>
</tr>
<tr>
    <td>Data Processing</td>
    <td>asr</td>
    <td></td>
    <td>01100</td>
    <td>12</td>
</tr>
<tr>
    <td>Branch</td>
    <td>b</td>
    <td></td>
    <td>10010</td>
    <td>18</td>
</tr>
<tr>
    <td>Branch</td>
    <td>call</td>
    <td></td>
    <td>10011</td>
    <td>19</td>
</tr>
<tr>
    <td>Branch</td>
    <td>ret</td>
    <td></td>
    <td>10100</td>
    <td>20</td>
</tr>
<tr>
    <td>Branch</td>
    <td>beq</td>
    <td></td>
    <td>10000</td>
    <td>16</td>
</tr>
<tr>
    <td>Branch</td>
    <td>bgt</td>
    <td></td>
    <td>10001</td>
    <td>17</td>
</tr>
<tr>
    <td>Special</td>
    <td>nop</td>
    <td></td>
    <td>01101</td>
    <td>13</td>
</tr>
</table>


<h3>This is the table that has the opcode and Instruction and Format</h3> <!-- chathpt did the table code generation, don't feel sorry!!!!! -->
<table border="1">
    <tr>
        <th>Inst.</th>
        <th>Code</th>
        <th>Format</th>
        <th>Inst.</th>
        <th>Code</th>
        <th>Format</th>
    </tr>
    <tr>
        <td>add</td>
        <td>00000</td>
        <td>add rd, rs1, (rs2/imm)</td>
        <td>lsl</td>
        <td>01010</td>
        <td>lsl rd, rs1, (rs2/imm)</td>
    </tr>
    <tr>
        <td>sub</td>
        <td>00001</td>
        <td>sub rd, rs1, (rs2/imm)</td>
        <td>lsr</td>
        <td>01011</td>
        <td>lsr rd, rs1, (rs2/imm)</td>
    </tr>
    <tr>
        <td>mul</td>
        <td>00010</td>
        <td>mul rd, rs1, (rs2/imm)</td>
        <td>asr</td>
        <td>01100</td>
        <td>asr rd, rs1, (rs2/imm)</td>
    </tr>
    <tr>
        <td>div</td>
        <td>00011</td>
        <td>div rd, rs1, (rs2/imm)</td>
        <td>nop</td>
        <td>01101</td>
        <td>nop</td>
    </tr>
    <tr>
        <td>mod</td>
        <td>00100</td>
        <td>mod rd, rs1, (rs2/imm)</td>
        <td>ld</td>
        <td>01110</td>
        <td>ld rd.imm[rs1]</td>
    </tr>
    <tr>
        <td>cmp</td>
        <td>00101</td>
        <td>cmp rs1, (rs2/imm)</td>
        <td>st</td>
        <td>01111</td>
        <td>st rd.imm[rs1]</td>
    </tr>
    <tr>
        <td>and</td>
        <td>00110</td>
        <td>and rd, rs1, (rs2/imm)</td>
        <td>beq</td>
        <td>10000</td>
        <td>beq offset</td>
    </tr>
    <tr>
        <td>or</td>
        <td>00111</td>
        <td>or rd, rs1, (rs2/imm)</td>
        <td>bgt</td>
        <td>10001</td>
        <td>bgt offset</td>
    </tr>
    <tr>
        <td>not</td>
        <td>01000</td>
        <td>not rd, (rs2/imm)</td>
        <td>b</td>
        <td>10010</td>
        <td>b offset</td>
    </tr>
    <tr>
        <td>mov</td>
        <td>01001</td>
        <td>mov rd, (rs2/imm)</td>
        <td>call</td>
        <td>10011</td>
        <td>call offset</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td>ret</td>
        <td>10100</td>
        <td>ret</td>
    </tr>
</table>

<h2>Instruction Encoding</h3>
<p>These are the rules that have to be followed inorder to encode the instructions</p>
<p>The Instruction Register is 32bits</p>
<ol>
<li>The Opcode takes 5bits at the MSB of the instruction Register</li>
<li>The 6th MSB takes R/I bit value>
<ul>
<li>6th MSB is 0, meaning Register Type instrucntion, the format is 7th - 10th MSB takes the Destinatioin Register value, and The next four bits for first Source register and the next four for the second Register</p>
<li>6th MSB is 1, meaning Immediate type instruction, the format is 7th - 10th MSB is Destination Registerm, the Next 4 bits for the source Register, and next 18 bits for the Immediate value, and in these 18bits, first two bits are for the modifier and the last 16bits for the immediate value</li>
<p>Modifier Values and there significance
<table>
<tr>
    <th>15th MSB</th>
    <th>16th MSB</th>
    <th>Meaning</th>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>Default(2's complement)</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>u(unsigned)<td>
</tr><tr>
<td>1</td>
<td>0</td>
<td>h(higher order)<td>
</tr>

</table>
</ul>
<li>The 4bit value taken by registers is there own register number, meaning r1 - 0001, r15 - 1111</li>
</ol>
<h4>0-Address Instruction Encoding Format</h4>
Instructions:- <i>nop, ret </i>
<p>The first five bits are for the Opcode</p>
<p>The next 27 bits are empty meaning 0</p>
<h4>1-Address Instruction Encdoing</h4>
Instructions:- <i>call, b, beq, bgt</i>
<p>The first five bits are for the Opcode</p>
<p>The next 27 bits are for the relative address</p>
<p>Meaning that PC(program counter) + offset*4, where offset is the 27bits immediate value</p>
<h4>3-Address Instruction Encoding Format</h4>
Instructions:- <i>add, sub, mul, div, mod, and, or, lsl, lsr, asr</i>
<p>The first five bits for the opcode</p>
<p>The 6th bit to specify whether instruction is R-Type or I-Type</p>
<p>If R-Type, 6th bit will be 0, then 7th - 10th bit will be Rd, 11th-14th will be Rs1 and 15th-19th will Rs2</p>
<p>here Rd will be Destination Register, Rs1 is first source register and Rs2 is second source register</p>
<p>If I-Type, 6th bit will be 1, then 7th - 10th bit will be Rd, 11th-14th bit will be Rs1 and 15th - 16th bit will be modifier, and next 16 bits will be immediate value</p>
<h4>2-Address Instructions Encoding format</h4>
Instructions: <i>cmp, not, mov</i>
<p>The first five bits will be opcode</p>
<p>For not and mov, the Rs1 place holder that is 11th -14th will be zero, for both R-type and I-type, in R-type Rd and Rs2 will be used, and in I-Type Rd and Immediate(last 18bits will be used)</p>
<p>For cmp, this opcode affects the flag, and influences the branch conditionals instructions, and the result of this is not stored in any destination register, hence only Rs1 and Rs2 will be used for R-Type, where I-Type it uses Rs1 and Immediate (last 18bits), now Rd will be zero for both cases</p>
<h4>ld and st instruction encoding</h4>
instruction:- <i>ld Rd, imm[rs1]</i>
<p>The format for this ld and st is, the first five bits are opcode, and Rd will be 7th to 10th bits, Rs1 will be 11th - 14th bits, and last 18 bits for the immediate value including modifier</p>

<pre>
Things To take care of:
0.Relative Addressing and ORG
1. Valid Opcode Verification
2. Valid operands for corresponding opcodes verificatrion
3. Mapping operands with there codes
4. Valid registers addressing modes
5. Modifiers considersation
6. Labels considerations, mapping with instruction address
7. Generation of binary file and then hexa file


Primary build up:
0. Verify the limit of immediate value, in MOV it can be 32bits 8hex but in other immediate it has to 16bits meaning 4hex
1. Create a function to convert decimal to binary
2. Create a function to convert hexa to binary
3. Create a mapping criteria for instruction line and Labels
4. Create a function to identify whether it is r or t type
5. Create a thing to tokenise thaem

Rules
1. The immediate value to be passed should be written in lower characters only
</pre>
</div>

</body>
</html>
